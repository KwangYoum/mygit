<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>버블 정렬 카드 애니메이션</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f3f3f3;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 40px 0;
    }
    #container {
      display: flex;
      gap: 16px;
      margin-bottom: 32px;
    }
    .card {
      width: 60px;
      height: 90px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      font-weight: bold;
      color: #333;
      transition: transform 0.4s cubic-bezier(.4,2.3,.3,1), background 0.2s;
      position: relative;
    }
    .card.active {
      background: #ffe082;
      color: #b26a00;
      z-index: 2;
    }
    .card.swap {
      background: #ff8a65;
      color: #fff;
      z-index: 3;
    }
    #sortBtn {
      padding: 12px 30px;
      font-size: 1.1rem;
      background: #1976d2;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-bottom: 20px;
      transition: background 0.2s;
    }
    #sortBtn:disabled {
      background: #b0bec5;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <button id="sortBtn">버블 정렬 시작</button>
  <div id="container"></div>
  <script>
    // 초기 배열 값
    let array = [5, 3, 8, 4, 2, 7, 1];
    const container = document.getElementById('container');
    const sortBtn = document.getElementById('sortBtn');

    // 카드 생성 함수
    function renderArray(arr, activeIndices = [], swapIndices = []) {
      container.innerHTML = '';
      arr.forEach((num, idx) => {
        const card = document.createElement('div');
        card.className = 'card';
        if (activeIndices.includes(idx)) card.classList.add('active');
        if (swapIndices.includes(idx)) card.classList.add('swap');
        card.textContent = num;
        container.appendChild(card);
      });
    }

    // 초기 렌더링
    renderArray(array);

    // 버블 정렬 애니메이션 함수
    async function bubbleSortAnimation(arr) {
      let len = arr.length;
      let swapped;
      for (let i = 0; i < len; i++) {
        swapped = false;
        for (let j = 0; j < len - i - 1; j++) {
          renderArray(arr, [j, j+1]); // 비교 중인 카드 하이라이트
          await sleep(500);

          if (arr[j] > arr[j + 1]) {
            renderArray(arr, [], [j, j+1]); // 교환 표시
            await sleep(400);

            // 실제 값 교환
            [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
            renderArray(arr, [], [j, j+1]);
            await sleep(400);

            swapped = true;
          }
        }
        // 한 패스 끝나면 전체 렌더
        renderArray(arr);
        await sleep(200);
        if (!swapped) break;
      }
      renderArray(arr); // 최종 정렬
      sortBtn.disabled = false;
    }

    // sleep 함수 (비동기 대기)
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    // 버튼 클릭 시 애니메이션 시작
    sortBtn.addEventListener('click', async () => {
      sortBtn.disabled = true;
      await bubbleSortAnimation([...array]);
    });

  </script>
</body>
</html>
